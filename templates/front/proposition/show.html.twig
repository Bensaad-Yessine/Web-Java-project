{% extends 'user/FrontOffice.html.twig' %}

{% block title %}{{ proposition_reunion.titre }} - ESPRIT{% endblock %}

{% block body %}
<main class="main">
<header class="header">
    <div>
        <h1 class="h1">{{ proposition_reunion.titre|default('Proposition de réunion') }}</h1>
        <p class="muted">{{ groupe_projet.nomProjet }} · {{ groupe_projet.matiere }}</p>
    </div>
    <span style="padding: 8px 18px; border-radius: var(--radius-lg); font-size: 14px; font-weight: 600; background: {% if proposition_reunion.status == 'Confirmée' %}var(--green-100){% elseif proposition_reunion.status == 'Annulée' %}var(--red-100){% elseif proposition_reunion.status == 'Reportée' %}var(--orange-100){% else %}var(--blue-100){% endif %}; color: {% if proposition_reunion.status == 'Confirmée' %}var(--green-900){% elseif proposition_reunion.status == 'Annulée' %}var(--red-900){% elseif proposition_reunion.status == 'Reportée' %}var(--orange-900){% else %}var(--blue-900){% endif %};">
        {{ proposition_reunion.status|default('En attente') }}
    </span>
</header>

{% for label, messages in app.flashes %}
    {% for message in messages %}
        <div class="alert alert-{{ label }}" style="margin-bottom: 20px; padding: 16px 20px; border-radius: 12px; background: {% if label == 'success' %}var(--green-50){% elseif label == 'error' %}var(--red-50){% else %}var(--blue-50){% endif %}; border: 1px solid {% if label == 'success' %}var(--green-200){% elseif label == 'error' %}var(--red-200){% else %}var(--blue-200){% endif %}; color: {% if label == 'success' %}var(--green-900){% elseif label == 'error' %}var(--red-900){% else %}var(--blue-900){% endif %};">
            {{ message }}
        </div>
    {% endfor %}
{% endfor %}

<div class="profile-container">
    <div style="display: flex; gap: 12px; margin-bottom: 24px; flex-wrap: wrap;">
        <a href="{{ path('front_proposition_reunion_index') }}" style="display: inline-flex; align-items: center; gap: 8px; padding: 12px 24px; background: white; color: var(--gray-700); text-decoration: none; border-radius: var(--radius-lg); font-weight: 600; border: 1px solid var(--gray-300); transition: all var(--transition);">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <line x1="19" y1="12" x2="5" y2="12"/><polyline points="12 19 5 12 12 5"/>
            </svg>
            Toutes les propositions
        </a>
        <a href="{{ path('front_groupe_projet_show', {'id': groupe_projet.id}) }}" style="display: inline-flex; align-items: center; gap: 8px; padding: 12px 24px; background: white; color: var(--gray-700); text-decoration: none; border-radius: var(--radius-lg); font-weight: 600; border: 1px solid var(--gray-300); transition: all var(--transition);">
            Voir le groupe
        </a>
        <a href="{{ path('front_proposition_reunion_edit', {'id': proposition_reunion.id}) }}" style="display: inline-flex; align-items: center; gap: 8px; padding: 12px 24px; background: linear-gradient(135deg, var(--orange-500), var(--red-500)); color: white; text-decoration: none; border-radius: var(--radius-lg); font-weight: 600; transition: all var(--transition);">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/>
            </svg>
            Modifier
        </a>
    </div>

    <!-- Main Content -->
    <div style="display: grid; grid-template-columns: 2fr 1fr; gap: 24px;">
        <!-- Left Column - Details -->
        <div>
            <!-- Date and Time Card -->
            <div class="card" style="margin-bottom: 24px; border-radius: var(--radius-lg); overflow: hidden; box-shadow: var(--shadow-sm);">
                <div style="padding: 20px 24px; border-bottom: 1px solid var(--gray-200); background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;">
                    <h2 style="margin: 0; font-size: 18px; font-weight: 700;">Informations de la réunion</h2>
                </div>
                <div style="padding: 24px;">
                    <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px; margin-bottom: 20px;">
                        <div style="display: flex; align-items: start; gap: 12px;">
                            <div style="width: 48px; height: 48px; border-radius: var(--radius-lg); background: var(--blue-100); display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="var(--blue-600)" stroke-width="2">
                                    <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/>
                                </svg>
                            </div>
                            <div>
                                <div style="font-size: 13px; color: var(--gray-500); margin-bottom: 4px; font-weight: 500;">Date de réunion</div>
                                <div style="font-size: 16px; font-weight: 700; color: var(--gray-900);">
                                    {{ proposition_reunion.dateReunion ? proposition_reunion.dateReunion|date('d/m/Y') : 'Non définie' }}
                                </div>
                                <div style="font-size: 13px; color: var(--gray-600); margin-top: 2px;">
                                    {{ proposition_reunion.dateReunion ? proposition_reunion.dateReunion|date('l', 'Europe/Paris')|trans : 'Non définie' }}
                                </div>
                            </div>
                        </div>

                        <div style="display: flex; align-items: start; gap: 12px;">
                            <div style="width: 48px; height: 48px; border-radius: var(--radius-lg); background: var(--purple-100); display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="var(--purple-600)" stroke-width="2">
                                    <circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/>
                                </svg>
                            </div>
                            <div>
                                <div style="font-size: 13px; color: var(--gray-500); margin-bottom: 4px; font-weight: 500;">Horaire</div>
                                <div style="font-size: 16px; font-weight: 700; color: var(--gray-900);">
                                    {{ proposition_reunion.heureDebut ? proposition_reunion.heureDebut|date('H:i') : '-' }} - {{ proposition_reunion.heureFin ? proposition_reunion.heureFin|date('H:i') : '-' }}
                                </div>
                                {% if proposition_reunion.heureDebut and proposition_reunion.heureFin %}
                                    {% set duration = (proposition_reunion.heureFin.timestamp - proposition_reunion.heureDebut.timestamp) / 60 %}
                                    <div style="font-size: 13px; color: var(--gray-600); margin-top: 2px;">
                                        Durée: {{ duration|round }} minutes
                                    </div>
                                {% endif %}
                            </div>
                        </div>
                    </div>

                    <div style="display: flex; align-items: start; gap: 12px; padding: 16px; background: var(--orange-50); border-radius: var(--radius-lg); border: 1px solid var(--orange-200);">
                        <div style="width: 48px; height: 48px; border-radius: var(--radius-lg); background: var(--orange-100); display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="var(--orange-600)" stroke-width="2">
                                <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"/><circle cx="12" cy="10" r="3"/>
                            </svg>
                        </div>
                        <div style="flex: 1;">
                            <div style="font-size: 13px; color: var(--orange-700); margin-bottom: 4px; font-weight: 600;">Lieu de réunion</div>
                            <div style="font-size: 16px; font-weight: 700; color: var(--orange-900);">
                                {{ proposition_reunion.lieu|default('Non défini') }}
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Description Card -->
            {% if proposition_reunion.description %}
                <div class="card" style="margin-bottom: 24px; border-radius: var(--radius-lg); overflow: hidden; box-shadow: var(--shadow-sm);">
                    <div style="padding: 20px 24px; border-bottom: 1px solid var(--gray-200);">
                        <h2 style="margin: 0; font-size: 18px; font-weight: 700; color: var(--gray-900);">Description</h2>
                    </div>
                    <div style="padding: 24px;">
                        <p style="margin: 0; color: var(--gray-700); line-height: 1.7; font-size: 15px; white-space: pre-wrap;">{{ proposition_reunion.description }}</p>
                    </div>
                </div>
            {% endif %}
        </div>

        <!-- Right Column - Sidebar -->
        <div>
            <!-- Group Info Card -->
            <div class="card" style="margin-bottom: 24px; border-radius: var(--radius-lg); overflow: hidden; box-shadow: var(--shadow-sm);">
                <div style="padding: 20px 24px; border-bottom: 1px solid var(--gray-200); background: linear-gradient(135deg, var(--red-500), var(--orange-500)); color: white;">
                    <h2 style="margin: 0; font-size: 16px; font-weight: 700;">Groupe</h2>
                </div>
                <div style="padding: 24px;">
                    <div style="margin-bottom: 16px;">
                        <div style="font-size: 13px; color: var(--gray-500); margin-bottom: 6px; font-weight: 500;">Nom du groupe</div>
                        <div style="font-size: 16px; font-weight: 700; color: var(--gray-900);">
                            {{ groupe_projet.nomProjet }}
                        </div>
                    </div>

                    <div style="margin-bottom: 16px;">
                        <div style="font-size: 13px; color: var(--gray-500); margin-bottom: 6px; font-weight: 500;">Matière</div>
                        <div style="font-size: 15px; font-weight: 600; color: var(--gray-800);">
                            {{ groupe_projet.matiere }}
                        </div>
                    </div>

                    <div style="margin-bottom: 20px;">
                        <div style="font-size: 13px; color: var(--gray-500); margin-bottom: 6px; font-weight: 500;">Membres</div>
                        <div style="font-size: 15px; font-weight: 600; color: var(--gray-800);">
                            {{ groupe_projet.idUser|length }} membre(s)
                        </div>
                    </div>

                    <a href="{{ path('front_groupe_projet_show', {'id': groupe_projet.id}) }}" style="display: block; width: 100%; padding: 12px; background: linear-gradient(135deg, var(--red-500), var(--orange-500)); color: white; text-decoration: none; border-radius: var(--radius-lg); font-weight: 600; font-size: 14px; text-align: center; transition: all var(--transition);">
                        Voir le groupe
                    </a>
                </div>
            </div>

            <!-- Status Info Card -->
            <div class="card" style="border-radius: var(--radius-lg); overflow: hidden; box-shadow: var(--shadow-sm);">
                <div style="padding: 20px 24px; border-bottom: 1px solid var(--gray-200);">
                    <h2 style="margin: 0; font-size: 16px; font-weight: 700; color: var(--gray-900);">Informations</h2>
                </div>
                <div style="padding: 24px;">
                    <div style="margin-bottom: 16px;">
                        <div style="font-size: 13px; color: var(--gray-500); margin-bottom: 6px; font-weight: 500;">Statut</div>
                        <span style="display: inline-block; padding: 6px 14px; border-radius: var(--radius); font-size: 13px; font-weight: 600; background: {% if proposition_reunion.status == 'Confirmée' %}var(--green-100){% elseif proposition_reunion.status == 'Annulée' %}var(--red-100){% elseif proposition_reunion.status == 'Reportée' %}var(--orange-100){% else %}var(--blue-100){% endif %}; color: {% if proposition_reunion.status == 'Confirmée' %}var(--green-900){% elseif proposition_reunion.status == 'Annulée' %}var(--red-900){% elseif proposition_reunion.status == 'Reportée' %}var(--orange-900){% else %}var(--blue-900){% endif %};">
                            {{ proposition_reunion.status|default('En attente') }}
                        </span>
                    </div>

                    {% if proposition_reunion.dateCreation %}
                        <div style="margin-bottom: 16px;">
                            <div style="font-size: 13px; color: var(--gray-500); margin-bottom: 6px; font-weight: 500;">Créée le</div>
                            <div style="font-size: 14px; color: var(--gray-700);">
                                {{ proposition_reunion.dateCreation|date('d/m/Y à H:i') }}
                            </div>
                        </div>
                    {% endif %}

                    {% if proposition_reunion.nbrVoteAccept is not null %}
                        <div>
                            <div style="font-size: 13px; color: var(--gray-500); margin-bottom: 6px; font-weight: 500;">Votes d'acceptation</div>
                            <div style="font-size: 20px; font-weight: 700; color: var(--green-600);">
                                {{ proposition_reunion.nbrVoteAccept }}
                            </div>
                        </div>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
</div>
</main>
{% endblock %}
