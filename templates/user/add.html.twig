<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>ESPRIT - Ajouter un Utilisateur</title>
    <!-- plugins:css -->
    <link rel="stylesheet" href="{{ asset('assets/vendors/mdi/css/materialdesignicons.min.css') }}">
    <link rel="stylesheet" href="{{ asset('assets/vendors/ti-icons/css/themify-icons.css') }}">
    <link rel="stylesheet" href="{{ asset('assets/vendors/css/vendor.bundle.base.css') }}">
    <link rel="stylesheet" href="{{ asset('assets/vendors/font-awesome/css/font-awesome.min.css') }}">
    <!-- Layout styles -->
    <link rel="stylesheet" href="{{ asset('assets/css/style.css') }}">
    <link rel="shortcut icon" href="{{ asset('assets/images/favicon.png') }}" />
    <style>
      body {
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
        background-color: #f5f7fa;
      }

      .form-container {
        background: white;
        border-radius: 12px;
        padding: 40px;
        box-shadow: 0 2px 12px rgba(0,0,0,0.08);
        max-width: 1200px;
        margin: 0 auto;
      }

      .form-header {
        border-bottom: 3px solid #667eea;
        padding-bottom: 25px;
        margin-bottom: 40px;
      }

      .form-header h4 {
        font-size: 1.75rem;
        font-weight: 600;
        color: #2d3748;
        margin-bottom: 8px;
      }

      .form-header p {
        font-size: 1rem;
        color: #718096;
        margin: 0;
      }

      .form-section {
        background: #ffffff;
        border: 2px solid #e2e8f0;
        padding: 30px;
        border-radius: 10px;
        margin-bottom: 30px;
        transition: all 0.3s ease;
      }

      .form-section:hover {
        border-color: #cbd5e0;
        box-shadow: 0 4px 12px rgba(0,0,0,0.05);
      }

      .form-section-title {
        color: #667eea;
        font-weight: 600;
        margin-bottom: 25px;
        font-size: 1.25rem;
        display: flex;
        align-items: center;
        padding-bottom: 15px;
        border-bottom: 2px solid #f0f4f8;
      }

      .form-section-title i {
        margin-right: 12px;
        font-size: 1.5rem;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
      }

      .required-field::after {
        content: " *";
        color: #e53e3e;
        font-weight: 700;
      }

      .form-group {
        margin-bottom: 25px;
      }

      .form-group label {
        font-weight: 600;
        color: #2d3748;
        margin-bottom: 10px;
        font-size: 0.95rem;
        display: block;
        letter-spacing: 0.3px;
      }

      .form-control {
        border: 2px solid #e2e8f0;
        border-radius: 8px;
        padding: 12px 16px;
        font-size: 1rem;
        color: #2d3748;
        transition: all 0.3s ease;
        background-color: #ffffff;
        width: 100%;
        font-weight: 400;
      }

      .form-control:hover {
        border-color: #cbd5e0;
      }

      .form-control:focus {
        border-color: #667eea;
        box-shadow: 0 0 0 4px rgba(102, 126, 234, 0.15);
        outline: none;
        background-color: #ffffff;
      }

      .form-control::placeholder {
        color: #a0aec0;
        font-weight: 400;
      }

      select.form-control {
        cursor: pointer;
        appearance: none;
        background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%23667eea' d='M6 9L1 4h10z'/%3E%3C/svg%3E");
        background-repeat: no-repeat;
        background-position: right 16px center;
        padding-right: 40px;
      }

      input[type="file"].form-control {
        padding: 10px 16px;
        line-height: 1.5;
      }

      .form-text {
        font-size: 0.875rem;
        color: #718096;
        margin-top: 8px;
        display: block;
        font-style: italic;
      }

      .btn-gradient-primary {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        border: none;
        color: white;
        padding: 14px 36px;
        border-radius: 8px;
        font-weight: 600;
        font-size: 1rem;
        transition: all 0.3s ease;
        cursor: pointer;
        display: inline-flex;
        align-items: center;
        gap: 8px;
      }

      .btn-gradient-primary:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 20px rgba(102, 126, 234, 0.3);
        color: white;
      }

      .btn-gradient-primary:active {
        transform: translateY(0);
      }

      .btn-light {
        background: #f7fafc;
        border: 2px solid #e2e8f0;
        color: #4a5568;
        padding: 14px 36px;
        border-radius: 8px;
        font-weight: 600;
        font-size: 1rem;
        transition: all 0.3s ease;
        cursor: pointer;
        display: inline-flex;
        align-items: center;
        gap: 8px;
      }

      .btn-light:hover {
        background: #edf2f7;
        border-color: #cbd5e0;
        color: #2d3748;
      }

      .error-message,
      .invalid-feedback {
        color: #e53e3e;
        font-size: 0.875rem;
        margin-top: 8px;
        font-weight: 500;
        display: block;
      }

      .form-actions {
        border-top: 2px solid #e2e8f0;
        padding-top: 30px;
        margin-top: 40px;
        text-align: right;
        display: flex;
        justify-content: flex-end;
        gap: 15px;
      }

      .img-thumbnail {
        border: 2px solid #e2e8f0;
        border-radius: 8px;
        padding: 8px;
        background: #f7fafc;
      }

      .row {
        margin-left: -12px;
        margin-right: -12px;
      }

      .col-md-6 {
        padding-left: 12px;
        padding-right: 12px;
      }

      /* Improved file upload styling */
      .file-upload-wrapper {
        position: relative;
      }

      .file-upload-label {
        display: inline-block;
        padding: 12px 24px;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        border-radius: 8px;
        cursor: pointer;
        font-weight: 600;
        transition: all 0.3s ease;
        font-size: 0.95rem;
      }

      .file-upload-label:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
      }

      .file-upload-label i {
        margin-right: 8px;
      }

      .current-photo-section {
        margin-top: 20px;
        padding: 20px;
        background: #f7fafc;
        border-radius: 8px;
        border: 2px dashed #cbd5e0;
      }

      .current-photo-section p {
        font-weight: 600;
        color: #4a5568;
        margin-bottom: 12px;
      }

      /* Better form validation styles */
      .form-control.is-invalid {
        border-color: #e53e3e;
        background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' fill='%23e53e3e' viewBox='0 0 16 16'%3E%3Cpath d='M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z'/%3E%3Cpath d='M7.002 11a1 1 0 1 1 2 0 1 1 0 0 1-2 0zM7.1 4.995a.905.905 0 1 1 1.8 0l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 4.995z'/%3E%3C/svg%3E");
        background-repeat: no-repeat;
        background-position: right 16px center;
        padding-right: 40px;
      }

      /* Responsive improvements */
      @media (max-width: 768px) {
        .form-container {
          padding: 25px;
        }

        .form-section {
          padding: 20px;
        }

        .form-actions {
          flex-direction: column-reverse;
        }

        .form-actions .btn {
          width: 100%;
          justify-content: center;
        }
      }
    </style>
  </head>
  <body>
    <div class="container-scroller">
      <!-- Sidebar -->
      <nav class="sidebar sidebar-offcanvas" id="sidebar">
        <div class="sidebar-brand-wrapper d-none d-lg-flex align-items-center justify-content-center fixed-top">
          <a class="sidebar-brand brand-logo" href="{{ path('app_user_index') }}">
            <img src="{{ asset('assets/images/logo.svg') }}" alt="logo" />
          </a>
          <a class="sidebar-brand brand-logo-mini" href="{{ path('app_user_index') }}">
            <img src="{{ asset('assets/images/logo-mini.svg') }}" alt="logo" />
          </a>
        </div>
        <ul class="nav">
          <li class="nav-item profile">
            <div class="profile-desc">
              <div class="profile-pic">
                <div class="count-indicator">
                  <img class="img-xs rounded-circle" src="{{ asset('assets/images/faces/face15.jpg') }}" alt="">
                  <span class="count bg-success"></span>
                </div>
                <div class="profile-name">
                  <h5 class="mb-0 font-weight-normal">Administrateur</h5>
                  <span>ESPRIT</span>
                </div>
              </div>
            </div>
          </li>
          <li class="nav-item nav-category">
            <span class="nav-link">Navigation</span>
          </li>
          
          <!-- Dashboard -->
          <li class="nav-item menu-items">
            <a class="nav-link" href="{{ path('app_user_index') }}">
              <span class="menu-icon">
                <i class="mdi mdi-speedometer"></i>
              </span>
              <span class="menu-title">Dashboard</span>
            </a>
          </li>
          
          <!-- Utilisateurs -->
          <li class="nav-item menu-items active">
            <a class="nav-link" href="{{ path('app_user_index') }}">
              <span class="menu-icon">
                <i class="mdi mdi-account-group"></i>
              </span>
              <span class="menu-title">Utilisateurs</span>
            </a>
          </li>
          
          <!-- Matières -->
          <li class="nav-item menu-items">
            <a class="nav-link" href="#">
              <span class="menu-icon">
                <i class="mdi mdi-book-open-page-variant"></i>
              </span>
              <span class="menu-title">Matieres</span>
            </a>
          </li>
          
          <!-- Classes -->
          <li class="nav-item menu-items">
            <a class="nav-link" href="#">
              <span class="menu-icon">
                <i class="mdi mdi-school"></i>
              </span>
              <span class="menu-title">Classes</span>
            </a>
          </li>
          
          <!-- Salles -->
          <li class="nav-item menu-items">
            <a class="nav-link" href="#">
              <span class="menu-icon">
                <i class="mdi mdi-office-building"></i>
              </span>
              <span class="menu-title">Salles</span>
            </a>
          </li>
          
          <!-- Séances -->
          <li class="nav-item menu-items">
            <a class="nav-link" href="#">
              <span class="menu-icon">
                <i class="mdi mdi-calendar-clock"></i>
              </span>
              <span class="menu-title">Séances</span>
            </a>
          </li>
          
          <!-- Groupes -->
          <li class="nav-item menu-items">
            <a class="nav-link" href="#">
              <span class="menu-icon">
                <i class="mdi mdi-account-multiple"></i>
              </span>
              <span class="menu-title">Groupes</span>
            </a>
          </li>
          
          <!-- Tâches -->
          <li class="nav-item menu-items">
            <a class="nav-link" href="#">
              <span class="menu-icon">
                <i class="mdi mdi-checkbox-marked-circle-outline"></i>
              </span>
              <span class="menu-title">Tâches</span>
            </a>
          </li>
          
          <!-- Alertes -->
          <li class="nav-item menu-items">
            <a class="nav-link" href="#">
              <span class="menu-icon">
                <i class="mdi mdi-alert-circle-outline"></i>
              </span>
              <span class="menu-title">Alertes</span>
            </a>
          </li>
          
          <!-- Exercices de santé -->
          <li class="nav-item menu-items">
            <a class="nav-link" href="#">
              <span class="menu-icon">
                <i class="mdi mdi-heart-pulse"></i>
              </span>
              <span class="menu-title">Exercices de santé</span>
            </a>
          </li>
          
          <!-- Logout -->
          <li class="nav-item menu-items">
            <a class="nav-link" href="#">
              <span class="menu-icon">
                <i class="mdi mdi-logout text-danger"></i>
              </span>
              <span class="menu-title text-danger">Déconnexion</span>
            </a>
          </li>
        </ul>
      </nav>

      <!-- Main Content -->
      <div class="container-fluid page-body-wrapper">
        <!-- Navbar -->
        <nav class="navbar p-0 fixed-top d-flex flex-row">
          <div class="navbar-brand-wrapper d-flex d-lg-none align-items-center justify-content-center">
            <img src="{{ asset('assets/images/logo.svg') }}" alt="logo" />
          </div>
          <div class="navbar-menu-wrapper flex-grow d-flex align-items-stretch">
            <button class="navbar-toggler navbar-toggler align-self-center" type="button" data-toggle="minimize">
              <span class="mdi mdi-menu"></span>
            </button>
            <ul class="navbar-nav w-100">
              <li class="nav-item w-100">
                <form class="nav-link mt-2 mt-md-0 d-none d-lg-flex search">
                  <input type="text" class="form-control" placeholder="Rechercher...">
                </form>
              </li>
            </ul>
            <ul class="navbar-nav navbar-nav-right">
              <li class="nav-item dropdown border-left">
                <a class="nav-link count-indicator dropdown-toggle" id="notificationDropdown" href="#" data-bs-toggle="dropdown">
                  <i class="mdi mdi-bell"></i>
                  <span class="count bg-danger">3</span>
                </a>
                <div class="dropdown-menu dropdown-menu-end navbar-dropdown preview-list" aria-labelledby="notificationDropdown">
                  <h6 class="p-3 mb-0">Notifications</h6>
                  <div class="dropdown-divider"></div>
                  <a class="dropdown-item preview-item">
                    <div class="preview-thumbnail">
                      <div class="preview-icon bg-warning rounded-circle">
                        <i class="mdi mdi-account-plus"></i>
                      </div>
                    </div>
                    <div class="preview-item-content">
                      <p class="preview-subject mb-1">Nouvel utilisateur</p>
                      <p class="text-muted ellipsis mb-0"> Ahmed Ben Ali inscrit</p>
                    </div>
                  </a>
                </div>
              </li>
              
              <li class="nav-item dropdown">
                <a class="nav-link" id="profileDropdown" href="#" data-bs-toggle="dropdown">
                  <div class="navbar-profile">
                    <img class="img-xs rounded-circle" src="{{ asset('assets/images/faces/face15.jpg') }}" alt="">
                    <p class="mb-0 d-none d-sm-block navbar-profile-name">Admin ESPRIT</p>
                    <i class="mdi mdi-menu-down d-none d-sm-block"></i>
                  </div>
                </a>
                <div class="dropdown-menu dropdown-menu-end navbar-dropdown preview-list" aria-labelledby="profileDropdown">
                  <h6 class="p-3 mb-0">Profil Administrateur</h6>
                  <div class="dropdown-divider"></div>
                  <a class="dropdown-item preview-item" href="#">
                    <div class="preview-thumbnail">
                      <div class="preview-icon bg-dark rounded-circle">
                        <i class="mdi mdi-logout text-danger"></i>
                      </div>
                    </div>
                    <div class="preview-item-content">
                      <p class="preview-subject mb-1">Déconnexion</p>
                    </div>
                  </a>
                </div>
              </li>
            </ul>
          </div>
        </nav>

        <!-- Content -->
        <div class="main-panel">
          <div class="content-wrapper">
            <!-- Header -->
            <div class="row">
              <div class="col-12">
                <div class="page-header">
                  <h3 class="page-title">
                    <span class="page-title-icon bg-gradient-primary text-white me-2">
                      <i class="mdi mdi-account-plus"></i>
                    </span> 
                    Ajouter un Utilisateur
                  </h3>
                  <nav aria-label="breadcrumb">
                    <ul class="breadcrumb">
                      <li class="breadcrumb-item">
                        <a href="{{ path('app_user_index') }}">Utilisateurs</a>
                      </li>
                      <li class="breadcrumb-item active" aria-current="page">
                        Ajouter un nouvel utilisateur
                      </li>
                    </ul>
                  </nav>
                </div>
              </div>
            </div>
            
            <!-- Form Container -->
            <div class="row">
              <div class="col-12">
                <div class="form-container">
                  <div class="form-header">
                    <h4>Informations du nouvel utilisateur</h4>
                    <p class="text-muted mb-0">Remplissez les informations ci-dessous pour ajouter un nouvel utilisateur au système ESPRIT.</p>
                  </div>
                  
                  {{ form_start(form, {'attr': {'class': 'form-horizontal', 'enctype': 'multipart/form-data'}}) }}
                  
                  {{ form_errors(form) }}
                  
                  <!-- Informations Personnelles -->
                  <div class="form-section">
                    <h5 class="form-section-title">
                      <i class="mdi mdi-account-outline"></i>
                      Informations Personnelles
                    </h5>
                    
                    <div class="row">
                      <div class="col-md-6">
                        <div class="form-group">
                          {{ form_label(form.nom, 'Nom', {'label_attr': {'class': 'required-field'}}) }}
                          {{ form_widget(form.nom, {
                            'attr': {
                              'class': 'form-control',
                              'placeholder': 'Entrez le nom de famille'
                            }
                          }) }}
                          {{ form_errors(form.nom) }}
                          <small class="form-text">Le nom de famille de l'utilisateur</small>
                        </div>
                      </div>
                      
                      <div class="col-md-6">
                        <div class="form-group">
                          {{ form_label(form.prenom, 'Prénom', {'label_attr': {'class': 'required-field'}}) }}
                          {{ form_widget(form.prenom, {
                            'attr': {
                              'class': 'form-control',
                              'placeholder': 'Entrez le prénom'
                            }
                          }) }}
                          {{ form_errors(form.prenom) }}
                          <small class="form-text">Le prénom de l'utilisateur</small>
                        </div>
                      </div>
                    </div>
                    
                    <div class="row">
                      <div class="col-md-6">
                        <div class="form-group">
                          {{ form_label(form.sexe, 'Sexe', {'label_attr': {'class': 'required-field'}}) }}
                          {{ form_widget(form.sexe, {
                            'attr': {
                              'class': 'form-control'
                            }
                          }) }}
                          {{ form_errors(form.sexe) }}
                          <small class="form-text">Sélectionnez le sexe de l'utilisateur</small>
                        </div>
                      </div>
                      
                      <div class="col-md-6">
                        <div class="form-group">
                          {{ form_label(form.DateDeNaissance, 'Date de Naissance') }}
                          {{ form_widget(form.DateDeNaissance, {
                            'attr': {
                              'class': 'form-control'
                            }
                          }) }}
                          {{ form_errors(form.DateDeNaissance) }}
                          <small class="form-text">Sélectionnez la date de naissance (format: JJ/MM/AAAA)</small>
                        </div>
                      </div>
                    </div>
                  </div>
                  
                  <!-- Informations Académiques -->
                  <div class="form-section">
                    <h5 class="form-section-title">
                      <i class="mdi mdi-school-outline"></i>
                      Informations Académiques
                    </h5>
                    
                    <div class="row">
                      <div class="col-md-6">
                        <div class="form-group">
                          {{ form_label(form.classe, 'Classe') }}
                          {{ form_widget(form.classe, {
                            'attr': {
                              'class': 'form-control',
                              'placeholder': 'Ex: 3ème année Informatique'
                            }
                          }) }}
                          {{ form_errors(form.classe) }}
                          <small class="form-text">La classe ou niveau académique actuel</small>
                        </div>
                      </div>
                      
                      <div class="col-md-6">
                        <div class="form-group">
                          {{ form_label(form.specialiteFuture, 'Spécialité Future') }}
                          {{ form_widget(form.specialiteFuture, {
                            'attr': {
                              'class': 'form-control',
                              'placeholder': 'Ex: Génie Logiciel, Réseaux & Sécurité'
                            }
                          }) }}
                          {{ form_errors(form.specialiteFuture) }}
                          <small class="form-text">La spécialité envisagée ou actuelle</small>
                        </div>
                      </div>
                    </div>
                    
                    <div class="row">
                      <div class="col-md-6">
                        <div class="form-group">
                          {{ form_label(form.role, 'Rôle', {'label_attr': {'class': 'required-field'}}) }}
                          {{ form_widget(form.role, {
                            'attr': {
                              'class': 'form-control'
                            }
                          }) }}
                          {{ form_errors(form.role) }}
                          <small class="form-text">Détermine les permissions et droits d'accès de l'utilisateur</small>
                        </div>
                      </div>
                    </div>
                  </div>
                  
                  <!-- Informations de Connexion -->
                  <div class="form-section">
                    <h5 class="form-section-title">
                      <i class="mdi mdi-lock-outline"></i>
                      Informations de Connexion
                    </h5>
                    
                    <div class="row">
                      <div class="col-md-12">
                        <div class="form-group">
                          {{ form_label(form.email, 'Adresse Email', {'label_attr': {'class': 'required-field'}}) }}
                          {{ form_widget(form.email, {
                            'attr': {
                              'class': 'form-control',
                              'placeholder': 'exemple@esprit.tn'
                            }
                          }) }}
                          {{ form_errors(form.email) }}
                          <small class="form-text">Adresse email unique pour la connexion et la communication</small>
                        </div>
                      </div>
                    </div>
                    
                    <div class="row">
                      <div class="col-md-6">
                        <div class="form-group">
                          {{ form_label(form.plainPassword, 'Mot de passe', {'label_attr': {'class': 'required-field'}}) }}
                          {{ form_widget(form.plainPassword, {
                            'attr': {
                              'class': 'form-control',
                              'placeholder': 'Minimum 8 caractères'
                            }
                          }) }}
                          {{ form_errors(form.plainPassword) }}
                          <small class="form-text">Mot de passe initial (minimum 8 caractères)</small>
                        </div>
                      </div>
                      
                      <div class="col-md-6">
                        <div class="form-group">
                          <label class="required-field">Confirmer le mot de passe</label>
                          <input type="password" class="form-control" placeholder="Retapez le mot de passe">
                          <small class="form-text">Confirmez le mot de passe pour éviter les erreurs</small>
                        </div>
                      </div>
                    </div>
                  </div>
                  
                  <!-- Photo de Profil -->
                  <div class="form-section">
                    <h5 class="form-section-title">
                      <i class="mdi mdi-camera-outline"></i>
                      Photo de Profil
                    </h5>
                    
                    <div class="row">
                      <div class="col-md-6">
                        <div class="form-group">
                          {{ form_label(form.profilePic, 'Photo de profil') }}
                          <div class="file-upload-wrapper">
                            {{ form_widget(form.profilePic, {
                              'attr': {
                                'class': 'form-control'
                              }
                            }) }}
                          </div>
                          {{ form_errors(form.profilePic) }}
                          <small class="form-text">Formats acceptés: JPG, PNG, GIF • Taille maximale: 5 MB</small>
                        </div>
                        
                        {% if form.vars.data and form.vars.data.profilePic %}
                          <div class="current-photo-section">
                            <p>Photo actuelle:</p>
                            <img src="{{ asset('uploads/profile_pics/' ~ form.vars.data.profilePic) }}" 
                                 alt="Photo actuelle" 
                                 class="img-thumbnail"
                                 style="max-width: 150px;">
                          </div>
                        {% endif %}
                      </div>
                    </div>
                  </div>
                  
                  <!-- Form Actions -->
                  <div class="form-actions">
                    <a href="{{ path('app_user_index') }}" class="btn btn-light">
                      <i class="mdi mdi-arrow-left"></i> Annuler
                    </a>
                    <button type="submit" class="btn btn-gradient-primary">
                      <i class="mdi mdi-content-save"></i> Enregistrer l'utilisateur
                    </button>
                  </div>
                  
                  {{ form_end(form) }}
                </div>
              </div>
            </div>
          </div>
          
          <!-- Footer -->
          <footer class="footer">
            <div class="d-sm-flex justify-content-center justify-content-sm-between">
              <span class="text-muted text-center text-sm-left d-block d-sm-inline-block">
                © 2024 ESPRIT École d'Ingénieurs. Tous droits réservés.
              </span>
              <span class="text-muted float-none float-sm-end d-block mt-1 mt-sm-0 text-center">
                Formulaire d'ajout d'utilisateur
              </span>
            </div>
          </footer>
        </div>
      </div>
    </div>

    <!-- Scripts -->
    <script src="{{ asset('assets/vendors/js/vendor.bundle.base.js') }}"></script>
    <script src="{{ asset('assets/js/off-canvas.js') }}"></script>
    <script src="{{ asset('assets/js/misc.js') }}"></script>
    
    
  </body>
</html>
